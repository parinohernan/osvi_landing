---
// src/components/molecules/PricingCard.astro

import Button from '../atoms/Button.astro';
import Icon from '../atoms/Icon.astro';
import { formatCurrency } from '../../utils/formatters';

interface Props {
  installments: number;
  installmentPrice: number;
  setupPrice: number;
  monthlyPrice: number;
  trialMonths: number;
  features: string[];
  whatsappNumber: string;
}

const { installments, installmentPrice, setupPrice, monthlyPrice, trialMonths, features, whatsappNumber } = Astro.props;

const message = `Hola, vi la landing y quiero consultar por el sistema. Mi distribuidora está en [CIUDAD].`;
---

<div class="pricing-card">
  <div class="pricing-card__header">
    <span class="pricing-card__badge">Oferta de lanzamiento</span>
    <div class="pricing-card__price">
      <span class="pricing-card__amount">{installments} cuotas de {formatCurrency(installmentPrice)}</span>
      <span class="pricing-card__period">pago inicial parcial</span>
    </div>
    <p class="pricing-card__trial">
      Incluye <strong>{trialMonths} meses gratis</strong> de servicio
    </p>
  </div>
  
  <ul class="pricing-card__features">
    {features.map(feature => (
      <li>
        <Icon name="check" size={20} />
        {feature}
      </li>
    ))}
  </ul>
  
  <div class="pricing-card__cta">
    <Button 
      href={`https://wa.me/${whatsappNumber.replace(/\D/g, '')}?text=${encodeURIComponent(message)}`}
      size="lg"
      fullWidth
    >
      <Icon name="whatsapp" size={20} />
      Consultar por WhatsApp
    </Button>
    <span class="pricing-card__note">Respuesta en menos de 1 hora</span>
  </div>
  
  <div class="pricing-card__footer">
    <p>Después de los {trialMonths} meses: <strong>{formatCurrency(monthlyPrice)}/mes</strong></p>
  </div>
</div>

<style>
  .pricing-card {
    background: white;
    border-radius: var(--radius-lg);
    box-shadow: 0 20px 25px -5px rgba(0,0,0,0.1);
    overflow: hidden;
    max-width: 480px;
    margin: 0 auto;
  }
  .pricing-card__header {
    background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-primary-dark) 100%);
    color: white;
    padding: var(--space-2xl);
    text-align: center;
  }
  .pricing-card__badge {
    display: inline-block;
    background: var(--color-secondary);
    color: white;
    font-size: var(--font-size-sm);
    font-weight: 600;
    padding: var(--space-xs) var(--space-md);
    border-radius: var(--radius-sm);
    margin-bottom: var(--space-lg);
  }
  .pricing-card__price {
    margin-bottom: var(--space-md);
  }
  .pricing-card__amount {
    display: block;
    font-size: var(--font-size-3xl);
    font-weight: 800;
  }
  .pricing-card__period {
    opacity: 0.9;
  }
  .pricing-card__trial {
    margin: 0;
    opacity: 0.9;
  }
  .pricing-card__features {
    list-style: none;
    padding: var(--space-xl);
    margin: 0;
  }
  .pricing-card__features li {
    display: flex;
    align-items: center;
    gap: var(--space-md);
    padding: var(--space-md) 0;
    border-bottom: 1px solid var(--color-border);
    color: var(--color-text);
  }
  .pricing-card__features li:last-child {
    border-bottom: none;
  }
  .pricing-card__cta {
    padding: 0 var(--space-xl) var(--space-xl);
  }
  .pricing-card__note {
    display: block;
    text-align: center;
    margin-top: var(--space-md);
    font-size: var(--font-size-sm);
    color: var(--color-text-muted);
  }
  .pricing-card__footer {
    background: var(--color-surface);
    padding: var(--space-lg) var(--space-xl);
    text-align: center;
    font-size: var(--font-size-sm);
    color: var(--color-text-muted);
  }
  .pricing-card__footer strong {
    color: var(--color-text);
  }
</style>